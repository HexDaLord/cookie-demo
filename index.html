<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Wie Websites dich erkennen ‚Äî Interaktive Demo (√úberarbeitet)</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    :root {
      --color-bg: #f6f8fa;
      --color-card: #ffffff;
      --color-primary: #4a90e2;
      --color-text-muted: #6b7280;
      --color-glass: rgba(255, 255, 255, 0.6);
      --color-border: #e6edf5;
      --color-shadow: rgba(2, 6, 23, 0.08);
      --color-shadow-light: rgba(2, 6, 23, 0.04);
      --gradient-header: linear-gradient(90deg, var(--color-primary), #2e6fb8);
      --gradient-info: linear-gradient(180deg, rgba(234, 244, 255, 0.5), transparent);
    }
    [data-theme="dark"] {
      --color-bg: #0f1724;
      --color-card: #0b1220;
      --color-primary: #60a5fa;
      --color-text-muted: #9ca3af;
      --color-glass: rgba(255, 255, 255, 0.03);
      --color-border: #2d3748;
      --color-shadow: rgba(0, 0, 0, 0.2);
      --color-shadow-light: rgba(0, 0, 0, 0.1);
      --gradient-header: linear-gradient(90deg, var(--color-primary), #3f6eb8);
      --gradient-info: linear-gradient(180deg, rgba(0, 50, 100, 0.3), transparent);
    }
    *, *::before, *::after { box-sizing: border-box; }
    body {
      font-family: Inter, "Segoe UI", Roboto, Arial, sans-serif;
      margin: 0;
      background: var(--color-bg);
      color: var(--color-text-muted);
      line-height: 1.5;
    }
    h1, h2, h3 { color: var(--color-primary); margin-top: 0; }
    h1 { font-size: 1.1rem; }
    h2, h3 { margin-bottom: 0.5rem; }
    p { margin-top: 0; }
    .muted { font-size: 0.9rem; color: var(--color-text-muted); }
    pre {
      background: rgba(0, 0, 0, 0.03);
      padding: 0.75rem;
      border-radius: 8px;
      overflow: auto;
      font-size: 0.92rem;
      color: var(--color-text-muted);
      white-space: pre-wrap;
    }
    header {
      background: var(--gradient-header);
      color: white;
      padding: 1.25rem 1rem;
      display: flex;
      gap: 1rem;
      align-items: center;
      justify-content: space-between;
    }
    header .brand { display: flex; gap: 0.75rem; align-items: center; }
    header h1 { margin: 0; color: white; }
    header p { margin: 0; font-size: 0.86rem; opacity: 0.95; }
    main { max-width: 1100px; margin: 1.25rem auto; padding: 1rem; }
    .layout {
      display: grid;
      grid-template-columns: 250px 1fr 300px; /* Sidebar / Content / Banner */
      gap: 1rem;
    }
    .sidebar { position: sticky; top: 1rem; align-self: start; }
    .card { background: var(--color-card); border-radius: 12px; padding: 1rem; box-shadow: 0 6px 20px var(--color-shadow); color: var(--color-text-muted); }
    .content { display: flex; flex-direction: column; gap: 1rem; }
    section { padding: 1rem; border-radius: 12px; background: var(--color-card); box-shadow: 0 6px 20px var(--color-shadow-light); }
    .info { background: var(--gradient-info); padding: 0.6rem; border-left: 4px solid var(--color-primary); border-radius: 8px; color: var(--color-text-muted); }
    footer { text-align: center; font-size: 0.82rem; color: var(--color-text-muted); margin-top: 1rem; padding-top: 1rem; }
    .progress { display: flex; gap: 0.5rem; align-items: center; margin-top: 0.5rem; overflow-x: auto; padding-bottom: 0.25rem; }
    .step { flex: 1 1 auto; min-width: 0; background: var(--color-glass); padding: 0.45rem 0.6rem; border-radius: 8px; text-align: center; font-weight: 600; color: var(--color-text-muted); cursor: pointer; }
    .step.active { background: var(--gradient-header); color: white; }
    .controls { display: flex; gap: 0.5rem; flex-wrap: wrap; margin-top: 0.7rem; }
    button {
      background: var(--color-primary);
      color: white;
      border: none;
      padding: 0.5rem 0.75rem;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: transform 0.1s ease, background-color 0.1s ease;
    }
    .btn-ghost { background: transparent; color: var(--color-primary); border: 1px solid var(--color-glass); }
    button:active { transform: translateY(1px); }
    button:hover:not(:active) { opacity: 0.9; }
    .form-row { display: flex; gap: 0.5rem; margin-top: 0.6rem; flex-wrap: wrap; }
    input[type=text], input[type=password], select { flex: 1; min-width: 150px; padding: 0.5rem 0.6rem; border-radius: 8px; border: 1px solid var(--color-border); font-size: 0.95rem; background: var(--color-card); color: var(--color-text-muted); }
    input[type=text]:focus, input[type=password]:focus, select:focus { outline: none; border-color: var(--color-primary); box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.2); }
    label { font-weight: 600; font-size: 0.95rem; color: var(--color-text-muted); }
    #map { height: 280px; border-radius: 8px; margin-top: 0.6rem; }
    table { width: 100%; border-collapse: collapse; margin-top: 0.6rem; }
    th, td { padding: 0.45rem 0.5rem; text-align: left; border-bottom: 1px solid rgba(0, 0, 0, 0.05); font-size: 0.9rem; }
    th { color: var(--color-text-muted); }
    .badge { display: inline-block; padding: 0.2rem 0.45rem; border-radius: 999px; font-size: 0.78rem; background: var(--color-glass); color: var(--color-text-muted); }

    /* --------------------- Ad Banner -------------------- */
    #ad-banner {
      display: none;
      position: sticky;
      top: 1rem;
      background: var(--color-card);
      border-radius: 12px;
      box-shadow: 0 6px 20px var(--color-shadow);
      padding: 0.75rem;
      text-align: center;
      transition: opacity 0.3s ease, transform 0.3s ease;
    }
    #ad-banner.active { display: block; opacity: 1; transform: translateY(0); }
    #ad-banner h4 { margin-top: 0; margin-bottom: 0.5rem; color: var(--color-primary); }
    #ad-banner img { max-width: 100%; height: auto; border-radius: 8px; margin-bottom: 0.5rem; }
    #ad-banner p { font-size: 0.85rem; color: var(--color-text-muted); }

    @media (max-width: 1400px) {
      .layout { grid-template-columns: 250px 1fr; }
      #ad-banner { position: static; width: 100%; margin-top: 1rem; transform: translateX(0); }
    }
    @media (max-width: 880px) {
      .layout { grid-template-columns: 1fr; }
      .form-row { flex-direction: column; }
      input[type=text], input[type=password], select { width: 100%; min-width: unset; }
    }
  </style>
</head>
<body data-theme="light">
  <header>
    <div class="brand">
      <div style="font-size:1.5rem">üç™</div>
      <div>
        <h1>Wie Websites dich erkennen</h1>
        <p>Interaktive Unterrichts-Demo ‚Äì Schulstufe: 9. Klasse / AHS 5. Klasse</p>
      </div>
    </div>
    <div style="display:flex; gap:.6rem; align-items:center">
      <div class="muted" id="welcome-text">Willkommen!</div>
      <button id="theme-toggle" class="btn-ghost">Dark</button>
    </div>
  </header>

  <main>
    <div class="layout">
      <aside class="sidebar">
        <!-- Sidebar-Inhalte unver√§ndert -->
        <div class="card">
          <h2>Schritt-f√ºr-Schritt</h2>
          <div class="muted">F√ºhre die Schritte durch, um Cookies & Tracking zu verstehen.</div>
          <div class="progress" id="progress">
            <div class="step" data-step="1">1. Cookies</div>
            <div class="step" data-step="2">2. Login</div>
            <div class="step" data-step="3">3. Ger√§t</div>
            <div class="step" data-step="4">4. Standort</div>
            <div class="step" data-step="5">5. Tracking</div>
          </div>
          <div style="margin-top:.8rem" class="muted">Schnellaktionen</div>
          <div class="controls">
            <button onclick="renderCookieTable()">Cookies anzeigen</button>
            <button onclick="clearAllCookies()" class="btn-ghost">Alle l√∂schen</button>
            <button onclick="simulateVisit()" class="btn-ghost">Seite neu laden (sim.)</button>
          </div>
        </div>
      </aside>

      <section class="content">
        <!-- Content-Sektionen unver√§ndert -->
        <section class="card">
          <h3>üç™ Cookies ‚Äì pers√∂nliche Begr√º√üung & Demo</h3>
          <div class="info">Diese Sektion zeigt wie persistent gespeicherte Cookies ...</div>
          <pre id="greeting">Hallo, Sch√ºler!</pre>
        </section>
        <!-- weitere Sektionen ... -->
      </section>

      <!-- Ad-Banner rechts neben dem Content -->
      <div id="ad-banner" class="card">
        <h4>Angebot nur f√ºr dich!</h4>
        <img id="ad-image" src="" alt="Werbebild">
        <p id="ad-text"></p>
        <button class="btn-ghost" onclick="hideAdBanner()">Schlie√üen</button>
      </div>
    </div>
  </main>

  <footer>¬© Unterrichts-Demo ‚Äì Keine Daten werden an Server √ºbertragen.</footer>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    // --------------------- Tracking Simulation --------------------
    const adContent = {
        'Mode': { image: 'images/Fashion.png', text: 'Entdecke die neuesten Trends! Exklusive Angebote f√ºr dich.', alt: 'Modische Kleidung' },
        'Musik': { image: 'images/Headphones.png', text: 'Tauche ein in deine Lieblingsmusik! Headsets & mehr im Angebot.', alt: 'Kopfh√∂rer' },
        'Tiere': { image: 'images/Cat_Rice_Cooker.png', text: 'Verw√∂hne deinen Vierbeiner! Gesundes Futter und Spielzeug.', alt: 'Katzenfutter' },
        'Kochen': { image: 'images/Cat_Rice_Cooker.png', text: 'Kreiere Meisterwerke in deiner K√ºche! Entdecke unsere Reiskocher.', alt: 'Reiskocher' },
        'Gaming': { image: 'images/Headphones.png', text: 'Hol dir den entscheidenden Vorteil! Top-Gaming-Gear warten auf dich.', alt: 'Gaming Headset' }
    };

    function showAdBanner(category) {
        const banner = document.getElementById('ad-banner');
        const img = document.getElementById('ad-image');
        const text = document.getElementById('ad-text');
        const content = adContent[category];
        if (content) {
            img.src = content.image;
            img.alt = content.alt;
            text.textContent = content.text;
            banner.classList.add('active');
        } else hideAdBanner();
    }

    function hideAdBanner() {
        const banner = document.getElementById('ad-banner');
        banner.classList.remove('active');
        document.getElementById('ad-image').src = '';
        document.getElementById('ad-image').alt = '';
        document.getElementById('ad-text').textContent = '';
    }

    function init() {
      // Init-Funktionen (Cookies, Theme, Session) ...
      renderCookieTable();
      applySavedTheme();
      updateSessionInfo();
      updateGreeting();

      // Banner nur beim Reload anzeigen
      if (performance.navigation.type === 1) { // Reload
          const lastCategory = localStorage.getItem('last_category');
          if (lastCategory) {
              document.getElementById('tracking-info').textContent =
                `Tracking aktiv (ID: ${getCookie('tracking_id')}). Letzte Kategorie: ${lastCategory}`;
              showAdBanner(lastCategory);
          }
      } else hideAdBanner();
    }

    document.addEventListener('DOMContentLoaded', init);

    // --------------------- Cookies & Theme Funktionen --------------------
    function setCookie(name, value, days) {
      let cookieString = `${name}=${encodeURIComponent(value)}; path=/`;
      if (typeof days === 'number' && days > 0) {
        const d = new Date();
        d.setTime(d.getTime() + days * 24 * 60 * 60 * 1000);
        cookieString += `; expires=${d.toUTCString()}`;
      }
      document.cookie = cookieString;
      renderCookieTable();
    }
    function getCookie(name) { const match = document.cookie.match(`(^|;)\\s*${name}=([^;]+)`); return match ? decodeURIComponent(match.pop()) : null; }
    function deleteCookie(name) { document.cookie = `${name}=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC`; renderCookieTable(); }
    function renderCookieTable() { /* ... unver√§ndert ... */ }
    function applySavedTheme() { /* ... unver√§ndert ... */ }
    function updateSessionInfo() { /* ... unver√§ndert ... */ }
    function updateGreeting() { /* ... unver√§ndert ... */ }

    function setTracking() {
      const id = Math.random().toString(36).slice(2,10);
      setCookie('tracking_id', id, 90);
      document.getElementById('tracking-info').textContent = `Tracking gesetzt: ${id}`;
    }
    function clearTracking() { deleteCookie('tracking_id'); localStorage.removeItem('last_category'); hideAdBanner(); }
  </script>
</body>
</html>
